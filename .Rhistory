Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI)
data1$value<-ifelse(data1$value>1,1,data1$value)
data1<-data1[!duplicated(data1), ]
Trad$value<-ifelse(Trad$value>1,1,Trad$value)
Trad1<-Trad1[!duplicated(Trad1), ]
Trad1
data1<-rbind(data1,Trad)
data1
data1 <- data1[data1$value >= 1, ]#
data1
s<-data1 %>%
group_by(Cat) %>%
summarise(species= length(species))
s
# Is there a way to only do species detected with that method ----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method, Species) %>%
summarise(Count= sum(value))
f
f$Sample<-f$variable
f$Combo<-NA
f$Combo[f$variable=="08-07-23 - SunC-REF"] <- "12S,COI,EF,GN,HN"
f$Combo[f$variable=="09-07-23 - SunC-REF"] <- "12S,COI,GN,HN,MT"
f$Combo[f$variable=="08-07-23 - SunC-EXP"] <- "12S,COI,EF,GN,HN,MT"
f$Combo[f$variable=="10-07-23 - KC-EXP"] <- "12S,COI,EF,MT"
f$Combo[f$variable=="11-07-23 - KC-REF"] <- "12S,COI,EF,MT, SN"
f$Combo[f$variable=="12-07-23 - SunC-FF"] <- "12S,COI,EF,GN"
f$Combo[f$variable=="09-07-23 - SunC-EXP"] <- "12S,COI,GN,HN,SN"
f$Combo[f$variable=="12-07-23 - RJ-POND"] <- "12S,COI,GN,MT"
f$Combo[f$variable=="12-07-23 - HC-REF"] <- "12S,COI,EF,GN,HN"
f$Combo[f$variable=="13-07-23 - HC-REF"] <- "12S,COI,GN,HN"
f <- f %>%
group_by(variable) %>%
mutate(`Total Number of Methods used` = length(unique(unlist(strsplit(Combo, ",")))))
filtered_data <- f %>%
group_by(Species, variable) %>%
filter(n_distinct(Method) == 1)
filtered_data_mean<-filtered_data  %>%
group_by(Method) %>%
summarise(Count= sum(Count),
Average_Number_methods_used= mean(`Total Number of Methods used`))
filtered_data_mean_old<-filtered_data_mean
Species_Only_detcted_with_one_method<-ggplot(filtered_data_mean, aes(x=factor(Method),Count*Average_Number_methods_used))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Weighted Uniqueness", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
Species_Only_detcted_with_one_method
filtered_data_mean$Count*filtered_data_mean$Average_Number_methods_used
p2_p3<-ggarrange(p3,p2,Species_Only_detcted_with_one_method,nrow=1, labels = c("B", "C","D"), font.label = list(size=10))
v<-results%>%
group_by(Method) %>%
summarise(mean= mean(sim))
v
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
data1
s<-data1 %>%
group_by(Cat) %>%
summarise(species= length(species))
s
s<-data1 %>%
group_by(Method) %>%
summarise(species= length(species))
s
# Diveristy
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
summarise(species= length(unique(species))
s<-data1 %>%
s<-data1 %>%
group_by(Method) %>%
summarise(species= length(unique(species)))
s
s<-data1 %>%
group_by(Method) %>%
summarise(species=(unique(species)))
View(s)
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
data1
p1
s<-data1 %>%
group_by(Method) %>%
summarise(species=length(unique(species)))
s
# Diveristy
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1
s<-data1 %>%
group_by(Method) %>%
summarise(species=length(unique(species)))
s
data1$value<-ifelse(data1$value>1,1,data1$value)
s
s<-data1 %>%
group_by(Method) %>%
summarise(species=length(unique(species)))
data1$value<-ifelse(data1$value>1,1,data1$value)
s<-data1 %>%
group_by(Method) %>%
summarise(species=length(unique(species)))
s
x<-data1
View(x)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
x<-data1
View(x)
7*18
s<-data1 %>%
group_by(Method) %>%
summarise(species=length(unique(species)))
s
# p5----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
Trad$value<-Trad$Count
Trad$variable<-Trad$Date_site
Trad<-subset(Trad, select=-c(Date_site,Count))
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
x<-combine(S12,COI)
x<-combine(x,Trad)
f<-x %>%
group_by(Method, Species) %>%
summarise(Count= sum(value))
f<- f[f$Count >= 1, ]#
f$Count<-ifelse(f$Count>1,1,f$Count)
S12<-f%>% filter(Method == "12S")
COI<-f%>% filter(Method == "COI")
EF<-f%>% filter(Method == "EF")
COI<-subset(COI, select=-c(Method))
S12<-subset(S12, select=-c(Method))
EF<-subset(EF, select=-c(Method))
all_all_not(S12,COI)
all_all_not(S12,EF)
all_all_not(EF,COI)
x
f
f<-x %>%
group_by(Method, Species) %>%
summarise(Count= length(unique(Species
)))
f
f<-x %>%
group_by(Method) %>%
summarise(Count= length(unique(Species
)))
f
# p5----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
Trad$value<-Trad$Count
Trad$variable<-Trad$Date_site
Trad<-subset(Trad, select=-c(Date_site,Count))
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
x<-combine(S12,COI)
x<-combine(x,Trad)
f<-x %>%
group_by(Method, Species) %>%
summarise(Count= sum(value))
f
# p5----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
Trad$value<-Trad$Count
Trad$variable<-Trad$Date_site
Trad<-subset(Trad, select=-c(Date_site,Count))
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
x<-combine(S12,COI)
x<-combine(x,Trad)
f<-x %>%
group_by(Method) %>%
summarise(Count= length(unique(Species)))
f
f<-x %>%
group_by(Cat) %>%
summarise(Count= length(unique(Species)))
f
f<-x %>%
group_by(Cat) %>%
summarise(Count= (unique(Species)))
f
f_edna<-f%>% filter(Cat== "eDNA")
f_trad<-f%>% filter(Cat== "Conventional")
symdiff(f_edna$Count,f_trad$Count)
intersect(f_edna$Count,f_trad$Count)
f_edna
f_trad
intersect(f_edna$Count,f_trad$Count) #7
15-7
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12
data1 <-S12
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
data1 <-S12
data1 <- data1[data1$value >= 1, ]#
data1
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value))))
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value)))
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value))
v
mean(v$max)
mean(v$min)
data1 <-COI
data1 <- data1[data1$value >= 1, ]#
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value))
mean(v$max)
mean(v$min)
data1 <-S12
data1 <- data1[data1$value >= 1, ]#
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value))
mean(v$max)
data1 <-COI
data1 <- data1[data1$value >= 1, ]#
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value))
mean(v$max)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
data1 <-S12
data1 <- data1[data1$value >= 1, ]#
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value),
mean=mean(value))
v
mean(data1$value)
data1 <-COI
data1 <- data1[data1$value >= 1, ]#
v<-data1 %>%
group_by(variable) %>%
summarise(max=max(value),
min=min(value))
mean(v$max)
mean(v$min)
mean(data1$value)
# Diveristy
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
data1
v<-data1 %>%
group_by(Method) %>%
summarise(Count= length(unique(Species)))
v<-data1 %>%
group_by(Method) %>%
summarise(Species=list(unique(Species)))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method) %>%
summarise(Count= sum(value))
f$Sample<-f$variable
# We need to account for the days the sampling method was used but no fish were found
sampling<-read_excel("Data/Detour Sampling.xlsx")
sampling$combined <- paste(sampling$Method, "-", sampling$Sample)
f$combined <- paste(f$Method, "-", f$Sample)
diff<-symdiff(f$combined,sampling$combined)
values_to_add <- c(diff)
# Values from symdiff
values_to_add <- c("HN - 08-07-23 - SunC-REF",
"HN - 09-07-23 - SunC-REF",
"MT - 09-07-23 - SunC-REF",
"MT - 08-07-23 - SunC-EXP",
"MT - 11-07-23 - KC-REF",
"EF - 12-07-23 - SunC-FF")
# Extract Method and Sample
methods <-c("HN","HN","MT","MT","MT","EF")
samples <-c("08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF")
# Create new rows with Method and Sample
new_rows <- data.frame(variable = values_to_add,
Method = methods,
Count = 0,
Sample = samples,
combined = values_to_add)
# Append new rows to dataframe f
f <- rbind(f, new_rows)
library(lmerTest)
model <- lmer(Count ~ as.factor(Method) + (1|variable), data = f)
summary(model)
plot(fitted(model), residuals(model))
qqnorm(residuals(model))
plot(ranef(model))
summary(model)
AIC(model)
ranef_values <- ranef(model)$variable  # Assuming random effects are for "variable"
hist(ranef_values$`(Intercept)`, main="Distribution of Random Effects", xlab="Random Effects")
install.packages("emmeans")
install.packages("emmeans")
library(emmeans)
citation("emmeans")
pairwise_comparisons <- emmeans(model, pairwise ~ Method,adjust = "BH")
pairwise_comparisons
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
p2
debugSource("~/Desktop/School/Detour 2.0/Scripts/Diversity.R", echo=TRUE)
pairwise_comparisons
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Diveristy
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
