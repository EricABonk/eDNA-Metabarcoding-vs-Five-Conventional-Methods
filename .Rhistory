geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method) %>%
summarise(Count= sum(value))
f$Sample<-f$variable
# We need to account for the days the sampling emthod was used but no fish were found
sampling<-read_excel("Data/Detour Sampling.xlsx")
sampling$combined <- paste(sampling$Method, "-", sampling$Sample)
f$combined <- paste(f$Method, "-", f$Sample)
diff<-symdiff(f$combined,sampling$combined)
values_to_add <- c(diff)
# Values from symdiff
values_to_add <- c("HN - 08-07-23 - SunC-REF",
"HN - 09-07-23 - SunC-REF",
"MT - 09-07-23 - SunC-REF",
"MT - 08-07-23 - SunC-EXP",
"MT - 11-07-23 - KC-REF",
"EF - 12-07-23 - SunC-FF")
# Extract Method and Sample
methods <-c("HN","HN","MT","MT","MT","EF")
samples <-c("08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF")
# Create new rows with Method and Sample
new_rows <- data.frame(variable = values_to_add,
Method = methods,
Count = 0,
Sample = samples,
combined = values_to_add)
# Append new rows to dataframe f
f <- rbind(f, new_rows)
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
t<-f%>%
group_by(Method) %>%
summarise(mean= mean(Count), error= std.error(Count))
shapiro.test(f$Count)
kruskal.test(f$Count,f$Method)
pairwise.wilcox.test(f$Count,f$Method)
library(plotrix)
#### Plot 3----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI)
data1$value<-ifelse(data1$value>1,1,data1$value)
data1<-data1[!duplicated(data1), ]
Trad$value<-ifelse(Trad$value>1,1,Trad$value)
Trad1<-Trad1[!duplicated(Trad1), ]
data1<-rbind(data1,Trad)
data1 <- data1[data1$value >= 1, ]#
data1$Value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(Species,variable,Cat) %>%
summarise(Count= sum(value))
f$Count<-ifelse(f$Count>1,1,f$Count)
f<-f%>%
group_by(variable,Cat) %>%
summarise(Count= sum(Count))
p3<-ggplot(f, aes(x=factor(Cat),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
p2_p3<-ggarrange(p3,p2, labels = c("B", "C"), font.label = list(size=10))
ggarrange(p1,p2_p3, labels = c("A"), ncol=1,font.label = list(size=10))
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method) %>%
summarise(Count= sum(value))
f$Sample<-f$variable
# We need to account for the days the sampling emthod was used but no fish were found
sampling<-read_excel("Data/Detour Sampling.xlsx")
sampling$combined <- paste(sampling$Method, "-", sampling$Sample)
f$combined <- paste(f$Method, "-", f$Sample)
diff<-symdiff(f$combined,sampling$combined)
values_to_add <- c(diff)
# Values from symdiff
values_to_add <- c("HN - 08-07-23 - SunC-REF",
"HN - 09-07-23 - SunC-REF",
"MT - 09-07-23 - SunC-REF",
"MT - 08-07-23 - SunC-EXP",
"MT - 11-07-23 - KC-REF",
"EF - 12-07-23 - SunC-FF")
# Extract Method and Sample
methods <-c("HN","HN","MT","MT","MT","EF")
samples <-c("08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF")
# Create new rows with Method and Sample
new_rows <- data.frame(variable = values_to_add,
Method = methods,
Count = 0,
Sample = samples,
combined = values_to_add)
# Append new rows to dataframe f
f <- rbind(f, new_rows)
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
t<-f%>%
group_by(Method) %>%
summarise(mean= mean(Count), error= std.error(Count))
t
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
p1
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=1,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
library(readxl)
x2<-read_excel("Data/12s200pb_species_table.xls")
x2<-X12s200pb_species_table
x2[x2<=75 ] <- 0
x2<-x2[rowSums(x2[7:70])>0,]
colnames(x2) <-sub("\\...*", "", colnames(x2))
unique(colnames(x2))
z<-t(rowsum(t(x2[7:70]), group = colnames(x2[7:70]), na.rm = T))
z<-as.data.frame(z)
z$Species<-x2$Species
x2<-z
x2$`13-07-23-HC-REF`
x2<-subset(x2, select=-c(`10-07-23-Negative_Control`,
`13-07-23-LIB-REF`,
`11-07-23-KC-DIVERT`,
`13-07-23-Negative_Control`,
`13-07-23-KC-EXP`,
`11-07-23-LIB-REF`,
`13-07-23-Negative_Control`,
`13-07-23-KC-EXP`,
`13-07-23-LIN-REF`,
`13-07-23-LIB-EXP`,
`13-07-23-LIN-EXP`,`09-07-23-Negative_Control`, `10-07-23-SC-REF`,`12-07-23-Negative_Control`))
# Assuming x2 is your vector or dataframe column
colnames(x2)[which(names(x2) == "08-07-23-SC-REF")] <- "08-07-23 - SunC-REF"
colnames(x2)[which(names(x2) == "09-07-23-SC-REF")] <- "09-07-23 - SunC-REF"
colnames(x2)[which(names(x2) == "08-07-23-SC-NF")] <- "08-07-23 - SunC-EXP"
colnames(x2)[which(names(x2) == "10-07-23-KC-EXP")] <- "10-07-23 - KC-EXP"
colnames(x2)[which(names(x2) == "11-07-23-KC-REF")] <- "11-07-23 - KC-REF"
colnames(x2)[which(names(x2) == "12-07-23-SC-FF")] <- "12-07-23 - SunC-FF"
colnames(x2)[which(names(x2) == "09-07-23-SC-NF")] <- "09-07-23 - SunC-EXP"
colnames(x2)[which(names(x2) == "11-07-23-FISH-POND")] <- "12-07-23 - RJ-POND"
colnames(x2)[which(names(x2) == "12-07-23-HC-REF")] <- "12-07-23 - HC-REF"
colnames(x2)[which(names(x2) == "13-07-23-HC-REF")] <- "13-07-23 - HC-REF"
colnames(x2)
x2<-read_excel("Data/12s200pb_species_table.xls")
x2<-X12s200pb_species_table
x2[x2<=75 ] <- 0
x2<-x2[rowSums(x2[7:70])>0,]
colnames(x2)
colnames(x2) <-sub("\\...*", "", colnames(x2))
colnames(x2)
c<-colnames(x2)
c<-as.data.frame(c)
v<-c %>%
group_by(c) %>%
summarise(Count= sum(c))
library(tidyverse)
v<-c %>%
group_by(c) %>%
summarise(Count= sum(c))
v<-c %>%
group_by(unique(c)) %>%
summarise(Count= length(c))
v<-c %>%
group_by(c) %>%
summarise(Count= length(c))
v
View(v)
# Make dataframe for Function
sampling<-read_excel("Data/Detour Sampling.xlsx")
library(readxl)
# Make dataframe for Function
sampling<-read_excel("Data/Detour Sampling.xlsx")
library(readxl)
S12<-read_excel("Data/12S Data.xlsx")
S12 <-S12[S12$value >= 1, ]
Trad<-read_excel("Data/Traditional Data.xlsx")
x2<-read_excel("Data/COI_species_table.xls")
x2[x2<=75 ] <- 0
x2<-x2[rowSums(x2[7:70])>0,]
colnames(x2) <-sub("\\...*", "", colnames(x2))
unique(colnames(x2))
z<-t(rowsum(t(x2[7:70]), group = colnames(x2[7:70]), na.rm = T))
z<-as.data.frame(z)
z$Species<-x2$Species
x2<-z
x2$`13-07-23-HC-REF`
x2<-subset(x2, select=-c(`10-07-23-Negative_Control`,
`13-07-23-LIB-REF`,
`11-07-23-KC-DIVERT`,
`13-07-23-Negative_Control`,
`13-07-23-KC-EXP`,
`11-07-23-LIB-REF`,
`13-07-23-Negative_Control`,
`13-07-23-KC-EXP`,
`13-07-23-LIN-REF`,
`13-07-23-LIB-EXP`,
`13-07-23-LIN-EXP`,`09-07-23-Negative_Control`, `10-07-23-SC-REF`,`12-07-23-Negative_Control`))
# Assuming x2 is your vector or dataframe column
colnames(x2)[which(names(x2) == "08-07-23-SC-REF")] <- "08-07-23 - SunC-REF"
colnames(x2)[which(names(x2) == "09-07-23-SC-REF")] <- "09-07-23 - SunC-REF"
colnames(x2)[which(names(x2) == "08-07-23-SC-NF")] <- "08-07-23 - SunC-EXP"
colnames(x2)[which(names(x2) == "10-07-23-KC-EXP")] <- "10-07-23 - KC-EXP"
colnames(x2)[which(names(x2) == "11-07-23-KC-REF")] <- "11-07-23 - KC-REF"
colnames(x2)[which(names(x2) == "12-07-23-SC-FF")] <- "12-07-23 - SunC-FF"
colnames(x2)[which(names(x2) == "09-07-23-SC-NF")] <- "09-07-23 - SunC-EXP"
colnames(x2)[which(names(x2) == "11-07-23-FISH-POND")] <- "12-07-23 - RJ-POND"
colnames(x2)[which(names(x2) == "12-07-23-HC-REF")] <- "12-07-23 - HC-REF"
colnames(x2)[which(names(x2) == "13-07-23-HC-REF")] <- "13-07-23 - HC-REF"
unique(colnames(x2))
x2
library(reshape2)
COI<- melt(x2, id.vars = "Species")
write_xlsx(COI, "Data/COI Data.xlsx")
x1<-read_excel("Data/Detour_fish_data.xls")
x1$Species[x1$Species == "BURB"] <- "Burbot"
x1$Species[x1$Species == "YLPR"] <- "Yellow Perch"
x1$Species[x1$Species == "WHSC"] <- "White Sucker"
x1$Species[x1$Species == "NRPK"] <- "Northern Pike"
x1$Species[x1$Species == "BRTR"] <- "Brook Trout"
x1$Species[x1$Species == "LKCH"] <- "Lake Chub"
x1$Species[x1$Species == "WALL"] <- "Walleye"
x1$Species[x1$Species == "CRCH"] <- "Creek Chub"
x1$Species[x1$Species == "MTSC"] <- "Mottled Sculpin"
x1$Species[x1$Species == "IWDR"] <- "Iowa Darter"
library(tidyverse)
x1$Date_site <- paste(x1$`Date (dd-MM-yy)`, "-", x1$Site)
x1<- x1%>% filter(Date_site %in% c( "08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"10-07-23 - KC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF",
"09-07-23 - SunC-EXP",
"12-07-23 - RJ-POND",
"12-07-23 - HC-REF",
"13-07-23 - HC-REF"
))
x1$Count<-c(1)
x1<-x1 %>%
group_by(Species,Date_site, Method) %>%
summarise(Count= sum(Count))
library(writexl)
write_xlsx(x1, "Data/Traditional Data.xlsx")
# Make dataframe for Function
sampling<-read_excel("Data/Detour Sampling.xlsx")
library(readxl)
S12<-read_excel("Data/12S Data.xlsx")
S12 <-S12[S12$value >= 1, ]
Trad<-read_excel("Data/Traditional Data.xlsx")
# Arrange_And_Conduct_RV_Coefficient() function
library(tidyverse)
library(ade4)
library(tidyverse)
library(ade4)
Arrange_And_Conduct_RV_Coefficient <- function(eDNA, Trad, methods_vector, Subgrouping_Column, Species_Column, Sample_Column, Value_Column) {
results <- list()
for (method in methods_vector) {
eDNA$type <- "eDNA"
Trad$type <- "Trad"
eDNA_filtered <- eDNA %>% filter(!!sym(Subgrouping_Column) == method)
Trad_filtered <- Trad %>% filter(!!sym(Subgrouping_Column) == method)
eDNA_combined <- rbind(eDNA_filtered, Trad_filtered)
eDNA_combined[[Value_Column]] <- ifelse(eDNA_combined$type == "Trad", 0, eDNA_combined[[Value_Column]])
Trad_combined <- rbind(eDNA_filtered, Trad_filtered)
Trad_combined[[Value_Column]] <- ifelse(Trad_combined$type == "eDNA", 0, Trad_combined[[Value_Column]])
species <- unique(eDNA_combined[[Species_Column]])
samples <- unique(eDNA_combined[[Sample_Column]])
eDNA_sum_matrix <- matrix(0, nrow = length(species), ncol = length(samples), dimnames = list(species, samples))
for (i in 1:nrow(eDNA_combined)) {
species_idx <- which(species == eDNA_combined[[Species_Column]][i])
sample_idx <- which(samples == eDNA_combined[[Sample_Column]][i])
eDNA_sum_matrix[species_idx, sample_idx] <- eDNA_sum_matrix[species_idx, sample_idx] + eDNA_combined[[Value_Column]][i]
}
eDNA_combined <- as.data.frame(eDNA_sum_matrix)
species <- unique(Trad_combined[[Species_Column]])
samples <- unique(Trad_combined[[Sample_Column]])
Trad_sum_matrix <- matrix(0, nrow = length(species), ncol = length(samples), dimnames = list(species, samples))
for (i in 1:nrow(Trad_combined)) {
species_idx <- which(species == Trad_combined[[Species_Column]][i])
sample_idx <- which(samples == Trad_combined[[Sample_Column]][i])
Trad_sum_matrix[species_idx, sample_idx] <- Trad_sum_matrix[species_idx, sample_idx] + Trad_combined[[Value_Column]][i]
}
Trad_combined <- as.data.frame(Trad_sum_matrix)
SN_MT_Results <- RV.rtest(Trad_combined, eDNA_combined, nrepet = 1000)
results[[method]] <- data.frame(Observation = SN_MT_Results$obs, P_Value = SN_MT_Results$pvalue)
}
# Combine the data frames into one table
combined_df <- do.call(rbind, Map(cbind, Method = names(results), results))
return(combined_df)
}
# Example data frame names and methods
library(readxl)
eDNA <- read_excel("Data/eDNA.xlsx")
Trad <- read_excel("Data/Trad.xlsx")
methods <- c("12S-EF", "12S-GN", "12S-HN", "12S-MT", "12S-SN", "COI-EF", "COI-GN", "COI-HN", "COI-MT", "COI-SN", "EF-GN", "EF-HN", "EF-MT", "EF-SN", "HN-GN", "HN-MT", "HN-SN", "SN-GN", "SN-MT", "MT-GN")
result <- Arrange_And_Conduct_RV_Coefficient(eDNA, Trad, methods, "Method", "Species", "Sample", "Value")
# Lets compare the results to the values we got from manually doing it
result$Observation<-as.numeric(result$Observation)
RV_Table<-read_excel("Data/RV Table.xlsx")
RV_Table$result<-result$Observation
RV_Table$Observation  <- as.numeric(RV_Table$Observation)
RV_Table$Observation <- round(RV_Table$Observation, 6)
RV_Table$result <- as.numeric(RV_Table$result)
RV_Table$result <- round(RV_Table$result, 6)
symdiff(RV_Table$result, RV_Table$Observation) # No Difference
# Now lets make plot
result$Relationship<-result$Method
combined_df_plot<-result
# Convert Observation and P_Value to numeric
combined_df_plot$Observation <- as.numeric(combined_df_plot$Observation)
combined_df_plot$P_Value <- as.numeric(combined_df_plot$P_Value)
# Split the Relationship column into two separate columns
combined_df_plot <- separate(combined_df_plot, Relationship, into = c("Relationship_1", "Relationship_2"), sep = "-")
combined_df_plot_reversed <- combined_df_plot
# Reverse the Relationship columns for combined_df_plot_reversed
combined_df_plot_reversed$Relationship_1 <- combined_df_plot$Relationship_2
combined_df_plot_reversed$Relationship_2 <- combined_df_plot$Relationship_1
# Append combined_df_plot_reversed to combined_df_plot
combined_df_plot <- rbind(combined_df_plot, combined_df_plot_reversed)
# Convert Relationship_1 and Relationship_2 to characters
combined_df_plot$Relationship_1 <- as.character(combined_df_plot$Relationship_1)
combined_df_plot$Relationship_2 <- as.character(combined_df_plot$Relationship_2)
# Sort the levels of Relationship_1 and Relationship_2 alphabetically
combined_df_plot$Relationship_1 <- factor(combined_df_plot$Relationship_1, levels = sort(unique(combined_df_plot$Relationship_1)))
combined_df_plot$Relationship_2 <- factor(combined_df_plot$Relationship_2, levels = sort(unique(combined_df_plot$Relationship_2)))
# Filter out the lower triangle
combined_df_plot <- combined_df_plot[as.character(combined_df_plot$Relationship_1) <= as.character(combined_df_plot$Relationship_2), ]
# Create the heatmap
heatmap <- ggplot(combined_df_plot, aes(x = Relationship_1, y = Relationship_2, fill = Observation)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "blue", high = "red") +
geom_text(aes(label = round(P_Value, 2)), color = "black") + # Add text for P-value
theme_minimal() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
labs(title = "",
x = "Method",
y = "Method",
fill = "RV Coefficient
")+ theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
heatmap
