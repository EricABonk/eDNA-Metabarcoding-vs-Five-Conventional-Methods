data1$value<-ifelse(data1$value>1,1,data1$value)
data1<-data1[!duplicated(data1), ]
Trad$value<-ifelse(Trad$value>1,1,Trad$value)
Trad1<-Trad1[!duplicated(Trad1), ]
data1<-rbind(data1,Trad)
data1 <- data1[data1$value >= 1, ]#
data1$Value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(Species,variable,Cat) %>%
summarise(Count= sum(value))
f$Count<-ifelse(f$Count>1,1,f$Count)
f<-f%>%
group_by(variable,Cat) %>%
summarise(Count= sum(Count))
p3<-ggplot(f, aes(x=factor(Cat),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Sample Technique")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(tidyverse)
t<-f%>%
group_by(Cat) %>%
summarise(mean= mean(Count), error= std.error(Count))
library(car)
library(plotrix)
t<-f%>%
group_by(Cat) %>%
summarise(mean= mean(Count), error= std.error(Count))
t
a<-aov(f$Count~f$Cat)
summary(a)
shapiro.test(f$Count) # Pass
leveneTest(f$Count,f$Cat) # Pass
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method) %>%
summarise(Count= sum(value))
f$Sample<-f$variable
# We need to account for the days the sampling emthod was used but no fish were found
sampling<-read_excel("Data/Detour Sampling.xlsx")
sampling$combined <- paste(sampling$Method, "-", sampling$Sample)
f$combined <- paste(f$Method, "-", f$Sample)
diff<-symdiff(f$combined,sampling$combined)
values_to_add <- c(diff)
# Values from symdiff
values_to_add <- c("HN - 08-07-23 - SunC-REF",
"HN - 09-07-23 - SunC-REF",
"MT - 09-07-23 - SunC-REF",
"MT - 08-07-23 - SunC-EXP",
"MT - 11-07-23 - KC-REF",
"EF - 12-07-23 - SunC-FF")
# Extract Method and Sample
methods <-c("HN","HN","MT","MT","MT","EF")
samples <-c("08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF")
# Create new rows with Method and Sample
new_rows <- data.frame(variable = values_to_add,
Method = methods,
Count = 0,
Sample = samples,
combined = values_to_add)
# Append new rows to dataframe f
f <- rbind(f, new_rows)
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Sample Technique")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
t<-f%>%
group_by(Method) %>%
summarise(mean= mean(Count), error= std.error(Count))
shapiro.test(f$Count)
kruskal.test(f$Count,f$Method)
pairwise.wilcox.test(f$Count,f$Method)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI)
data1$value<-ifelse(data1$value>1,1,data1$value)
data1<-data1[!duplicated(data1), ]
Trad$value<-ifelse(Trad$value>1,1,Trad$value)
Trad1<-Trad1[!duplicated(Trad1), ]
data1<-rbind(data1,Trad)
data1 <- data1[data1$value >= 1, ]#
data1$Value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(Species,variable,Cat) %>%
summarise(Count= sum(value))
f$Count<-ifelse(f$Count>1,1,f$Count)
f<-f%>%
group_by(variable,Cat) %>%
summarise(Count= sum(Count))
p3<-ggplot(f, aes(x=factor(Cat),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Sample Technique")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
ggarrange(p1,p3,p2, labels = c("A", "B"), font.label = list(size=10))
p2_p3<-ggarrange(p3,p2, labels = c("B", "C"), font.label = list(size=10))
ggarrange(p1,p2_p3, labels = c("A"), font.label = list(size=10))
ggarrange(p1,p2_p3, labels = c("A"), ncol=1,font.label = list(size=10))
p3<-ggplot(f, aes(x=factor(Cat),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method) %>%
summarise(Count= sum(value))
f$Sample<-f$variable
# We need to account for the days the sampling emthod was used but no fish were found
sampling<-read_excel("Data/Detour Sampling.xlsx")
sampling$combined <- paste(sampling$Method, "-", sampling$Sample)
f$combined <- paste(f$Method, "-", f$Sample)
diff<-symdiff(f$combined,sampling$combined)
values_to_add <- c(diff)
# Values from symdiff
values_to_add <- c("HN - 08-07-23 - SunC-REF",
"HN - 09-07-23 - SunC-REF",
"MT - 09-07-23 - SunC-REF",
"MT - 08-07-23 - SunC-EXP",
"MT - 11-07-23 - KC-REF",
"EF - 12-07-23 - SunC-FF")
# Extract Method and Sample
methods <-c("HN","HN","MT","MT","MT","EF")
samples <-c("08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF")
# Create new rows with Method and Sample
new_rows <- data.frame(variable = values_to_add,
Method = methods,
Count = 0,
Sample = samples,
combined = values_to_add)
# Append new rows to dataframe f
f <- rbind(f, new_rows)
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
t<-f%>%
group_by(Method) %>%
summarise(mean= mean(Count), error= std.error(Count))
shapiro.test(f$Count)
kruskal.test(f$Count,f$Method)
pairwise.wilcox.test(f$Count,f$Method)
library(plotrix)
#### Plot 3----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI)
data1$value<-ifelse(data1$value>1,1,data1$value)
data1<-data1[!duplicated(data1), ]
Trad$value<-ifelse(Trad$value>1,1,Trad$value)
Trad1<-Trad1[!duplicated(Trad1), ]
data1<-rbind(data1,Trad)
data1 <- data1[data1$value >= 1, ]#
data1$Value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(Species,variable,Cat) %>%
summarise(Count= sum(value))
f$Count<-ifelse(f$Count>1,1,f$Count)
f<-f%>%
group_by(variable,Cat) %>%
summarise(Count= sum(Count))
p3<-ggplot(f, aes(x=factor(Cat),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
p2_p3<-ggarrange(p3,p2, labels = c("B", "C"), font.label = list(size=10))
ggarrange(p1,p2_p3, labels = c("A"), ncol=1,font.label = list(size=10))
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
f<-data1 %>%
group_by(variable,Method) %>%
summarise(Count= sum(value))
f$Sample<-f$variable
# We need to account for the days the sampling emthod was used but no fish were found
sampling<-read_excel("Data/Detour Sampling.xlsx")
sampling$combined <- paste(sampling$Method, "-", sampling$Sample)
f$combined <- paste(f$Method, "-", f$Sample)
diff<-symdiff(f$combined,sampling$combined)
values_to_add <- c(diff)
# Values from symdiff
values_to_add <- c("HN - 08-07-23 - SunC-REF",
"HN - 09-07-23 - SunC-REF",
"MT - 09-07-23 - SunC-REF",
"MT - 08-07-23 - SunC-EXP",
"MT - 11-07-23 - KC-REF",
"EF - 12-07-23 - SunC-FF")
# Extract Method and Sample
methods <-c("HN","HN","MT","MT","MT","EF")
samples <-c("08-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"09-07-23 - SunC-REF",
"08-07-23 - SunC-EXP",
"11-07-23 - KC-REF",
"12-07-23 - SunC-FF")
# Create new rows with Method and Sample
new_rows <- data.frame(variable = values_to_add,
Method = methods,
Count = 0,
Sample = samples,
combined = values_to_add)
# Append new rows to dataframe f
f <- rbind(f, new_rows)
p2<-ggplot(f, aes(x=factor(Method),Count))+
geom_bar(stat="summary")+
stat_summary(fun.data = mean_se,
geom = "errorbar") +
labs(y="Diversity", x="Method")+
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
t<-f%>%
group_by(Method) %>%
summarise(mean= mean(Count), error= std.error(Count))
t
library(tidyverse)
library(readxl)
library(plotrix)
S12<-read_excel("Data/12S Data.xlsx")
Trad<-read_excel("Data/Traditional Data.xlsx")
COI<-read_excel("Data/COI Data.xlsx")
S12$Method<-"12S"
COI$Method<-"COI"
Trad$variable<-Trad$Date_site
Trad$value<-Trad$Count
Trad<-subset(Trad, select=-c(Date_site,Count))
Trad$Cat<-"Conventional"
S12$Cat<-"eDNA"
COI$Cat<-"eDNA"
data1<-rbind(S12,COI, Trad)
data1 <- data1[data1$value >= 1, ]#
data1$value<-ifelse(data1$value>1,1,data1$value)
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=3,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
p1
p1<-ggplot(data1,aes(variable, Species, group=Method, color =Method)) +
geom_point(aes(fill=Method), position=position_dodge(width=0.5),colour="black", shape=21,size=1,stroke=1)+
labs(y="Species", x="Sample")+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(colour = guide_legend(title = "Method",ncol = 1))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
# Plot 2----
S12<-read_excel("Data/12S Data.xlsx")
library(readxl)
x2<-read_excel("Data/12s200pb_species_table.xls")
x2<-X12s200pb_species_table
x2[x2<=75 ] <- 0
x2<-x2[rowSums(x2[7:70])>0,]
colnames(x2) <-sub("\\...*", "", colnames(x2))
unique(colnames(x2))
z<-t(rowsum(t(x2[7:70]), group = colnames(x2[7:70]), na.rm = T))
z<-as.data.frame(z)
z$Species<-x2$Species
x2<-z
x2$`13-07-23-HC-REF`
x2<-subset(x2, select=-c(`10-07-23-Negative_Control`,
`13-07-23-LIB-REF`,
`11-07-23-KC-DIVERT`,
`13-07-23-Negative_Control`,
`13-07-23-KC-EXP`,
`11-07-23-LIB-REF`,
`13-07-23-Negative_Control`,
`13-07-23-KC-EXP`,
`13-07-23-LIN-REF`,
`13-07-23-LIB-EXP`,
`13-07-23-LIN-EXP`,`09-07-23-Negative_Control`, `10-07-23-SC-REF`,`12-07-23-Negative_Control`))
# Assuming x2 is your vector or dataframe column
colnames(x2)[which(names(x2) == "08-07-23-SC-REF")] <- "08-07-23 - SunC-REF"
colnames(x2)[which(names(x2) == "09-07-23-SC-REF")] <- "09-07-23 - SunC-REF"
colnames(x2)[which(names(x2) == "08-07-23-SC-NF")] <- "08-07-23 - SunC-EXP"
colnames(x2)[which(names(x2) == "10-07-23-KC-EXP")] <- "10-07-23 - KC-EXP"
colnames(x2)[which(names(x2) == "11-07-23-KC-REF")] <- "11-07-23 - KC-REF"
colnames(x2)[which(names(x2) == "12-07-23-SC-FF")] <- "12-07-23 - SunC-FF"
colnames(x2)[which(names(x2) == "09-07-23-SC-NF")] <- "09-07-23 - SunC-EXP"
colnames(x2)[which(names(x2) == "11-07-23-FISH-POND")] <- "12-07-23 - RJ-POND"
colnames(x2)[which(names(x2) == "12-07-23-HC-REF")] <- "12-07-23 - HC-REF"
colnames(x2)[which(names(x2) == "13-07-23-HC-REF")] <- "13-07-23 - HC-REF"
colnames(x2)
x2<-read_excel("Data/12s200pb_species_table.xls")
x2<-X12s200pb_species_table
x2[x2<=75 ] <- 0
x2<-x2[rowSums(x2[7:70])>0,]
colnames(x2)
colnames(x2) <-sub("\\...*", "", colnames(x2))
colnames(x2)
c<-colnames(x2)
c<-as.data.frame(c)
v<-c %>%
group_by(c) %>%
summarise(Count= sum(c))
library(tidyverse)
v<-c %>%
group_by(c) %>%
summarise(Count= sum(c))
v<-c %>%
group_by(unique(c)) %>%
summarise(Count= length(c))
v<-c %>%
group_by(c) %>%
summarise(Count= length(c))
v
View(v)
