# Left join missing data with filtered datasets and replace NA values with 0
eDNA_RV_12S_EF <- left_join(missing_data, eDNA_RV_12S_EF, by = c("Sample", "Species")) %>%
mutate(Value = coalesce(Value, 0))
# Left join missing data with filtered datasets and replace NA values with 0
eDNA_RV_12S_EF <- left_join(missing_data, eDNA_RV_12S_EF, by = c("Sample", "Method")) %>%
mutate(Value = coalesce(Value, 0))
# Left join missing data with filtered datasets and replace NA values with 0
eDNA_RV_12S_EF <- left_join(missing_data, eDNA_RV_12S_EF, by = c("Sample")) %>%
mutate(Value = coalesce(Value, 0))
# Filter data for 12S-EF method from each dataset
eDNA_RV_12S_EF <- eDNA_RV %>% filter(Method == "12S-EF")
Trad_RV_12S_EF <- Trad_RV %>% filter(Method == "12S-EF")
# Get unique samples from both datasets
all_samples <- union(eDNA_RV_12S_EF$Sample, Trad_RV_12S_EF$Sample)
# Create a dataframe with all possible combinations of samples and species
missing_data <- expand.grid(Sample = all_samples, Species = unique(eDNA_RV_12S_EF$Species))
eDNA_RV_12S_EF
# Get unique species from the column names
all_species <- colnames(eDNA_RV_12S_EF)[4:length(colnames(eDNA_RV_12S_EF))]
# Get unique samples from both datasets
all_samples <- union(eDNA_RV_12S_EF$Sample, Trad_RV_12S_EF$Sample)
# Create a dataframe with all possible combinations of samples and species
missing_data <- expand.grid(Sample = all_samples, Species = all_species)
# Add a Value column with zeros to the missing_data dataframe
missing_data$Value <- 0
# Left join missing data with filtered datasets and replace NA values with 0
eDNA_RV_12S_EF <- left_join(missing_data, eDNA_RV_12S_EF, by = "Sample") %>%
mutate(Value = coalesce(Value.y, 0)) %>%
select(-Value.y)
# Get unique species from the column names
all_species <- colnames(eDNA_RV_12S_EF)[4:length(colnames(eDNA_RV_12S_EF))]
# Get unique samples from both datasets
all_samples <- union(eDNA_RV_12S_EF$Sample, Trad_RV_12S_EF$Sample)
# Create a dataframe with all possible combinations of samples and species
missing_data <- expand.grid(Sample = all_samples, Species = all_species)
# Left join missing data with filtered datasets and replace NA values with 0
eDNA_RV_12S_EF <- left_join(missing_data, eDNA_RV_12S_EF, by = "Sample") %>%
mutate(Value = ifelse(is.na(Value), 0, Value))
# Left join missing data with filtered datasets
eDNA_RV_12S_EF <- left_join(missing_data, eDNA_RV_12S_EF, by = "Sample")
# Print the joined dataframe
print(eDNA_RV_12S_EF)
eDNA_RV_12S_EF <- left_join(eDNA_RV_12S_EF, missing_data, by = "Sample") %>%
mutate(across(starts_with("Value"), ~ifelse(is.na(.), 0, .))) %>%
select(-Species)
# Check for duplicate samples in eDNA_RV_12S_EF
eDNA_RV_12S_EF_duplicates <- eDNA_RV_12S_EF %>%
group_by(Sample) %>%
filter(n() > 1)
# Check for duplicate samples in missing_data
missing_data_duplicates <- missing_data %>%
group_by(Sample) %>%
filter(n() > 1)
# Remove duplicates from eDNA_RV_12S_EF
eDNA_RV_12S_EF_unique <- eDNA_RV_12S_EF %>%
distinct()
# Remove duplicates from missing_data
missing_data_unique <- missing_data %>%
distinct()
# Perform the left join operation
eDNA_RV_12S_EF <- left_join(eDNA_RV_12S_EF_unique, missing_data_unique, by = "Sample") %>%
mutate(across(starts_with("Value"), ~ifelse(is.na(.), 0, .)))
# Check the resulting dataframe
print(eDNA_RV_12S_EF)
eDNA$type <- "eDNA"
Trad$type <- "Trad"
# Combine the datasets
data <- bind_rows(eDNA, Trad)
RV <- data %>%
pivot_wider(names_from = Species, values_from = Value)
RV
# Filter data based on type
eDNA_RV <- RV %>% filter(type == "eDNA")
Trad_RV <- RV %>% filter(type == "Trad")
View(Trad_RV)
symdiff(eDNA_RV$Sample,Trad_RV$Sample)
View(eDNA_RV)
library(tidyverse)
library(ade4)
library(readxl)
library(writexl)
all_all_not <- function(a, b) {
all <- intersect(a, b)
all_not <- symdiff(a, b)
# Create data frames with a single column for 'all' and 'all_not'
all<- data.frame(Value = all)
all_not <- data.frame(Value = all_not)
# Print the lengths of the data frames
all<-(nrow(all))
all_not <-(nrow(all_not))
data.frame(all=all, not=all_not)
}
Accuracy_Consistency<- function(a, b, column_name, conf.level = 0.95) {
# Check if the specified column is empty in either data frame
if (all(is.na(unique(a[[column_name]]))) || all(is.na(unique(b[[column_name]])))) {
print("The specified column is empty in one or both data frames. Comparing entire data frames.")
result <- all_all_not(a, b)
consistency <- sum(result$all) / (sum(result$all) + sum(result$not))
ci_consistency <- prop.test(sum(result$all), sum(result$all) + sum(result$not), conf.level = conf.level)$conf.int
ci_lower <- ci_consistency[1]
ci_upper <- ci_consistency[2]
accuracy <- sum(result$all) / nrow(a)
result$Consistency <- consistency
result$Consistency_Lower <- ci_lower
result$Consistency_Upper <- ci_upper
result$Accuracy <- accuracy
acc_ci <- prop.test(sum(result$all), nrow(a), conf.level = conf.level)$conf.int
result$Accuracy_Lower <- acc_ci[1]
result$Accuracy_Upper <- acc_ci[2]
return(result)
}
# Get unique values of the specified column from both data frames
values_a <- unique(a[[column_name]])
values_b <- unique(b[[column_name]])
# Initialize lists to store subsets
subsets_a <- list()
subsets_b <- list()
# Create subsets for data frame 'a'
for (value in values_a) {
subset_a <- subset(a, a[[column_name]] == value)
subsets_a[[as.character(value)]] <- subset_a
}
# Create subsets for data frame 'b'
for (value in values_b) {
subset_b <- subset(b, b[[column_name]] == value)
subsets_b[[as.character(value)]] <- subset_b
}
# Initialize a list to store results
results <- list()
# Apply 'all_all_not' function to each pair of non-empty subsets
for (value in names(subsets_a)) {
if (!is.null(subsets_a[[value]]) && !is.null(subsets_b[[value]])) {
print(paste("Processing value:", value))
result <- all_all_not(subsets_a[[value]], subsets_b[[value]])
consistency <- sum(result$all) / (sum(result$all) + sum(result$not))
ci_consistency <- prop.test(sum(result$all), sum(result$all) + sum(result$not), conf.level = conf.level)$conf.int
ci_lower_consistency <- ci_consistency[1]
ci_upper_consistency <- ci_consistency[2]
accuracy <- sum(result$all) / nrow(subsets_a[[value]])
result$Consistency <- consistency
result$Consistency_Lower <- ci_lower_consistency
result$Consistency_Upper <- ci_upper_consistency
result$Accuracy <- accuracy
acc_ci <- prop.test(sum(result$all), nrow(subsets_a[[value]]), conf.level = conf.level)$conf.int
result$Accuracy_Lower <- acc_ci[1]
result$Accuracy_Upper <- acc_ci[2]
results[[value]] <- result
}
}
# Combine results into a single data frame
if (length(results) > 0) {
df <- do.call(rbind, results)
df <- data.frame(Variable = row.names(df), df, row.names = NULL)
return(df)
} else {
print("No non-empty subsets found.")
return(NULL)
}
}
#----
# By method----
eDNA<-read_excel("eDNA.xlsx")
Trad<-read_excel("Trad.xlsx")
eDNA <-eDNA[eDNA $Value >= 1, ]
eDNA$Value[eDNA $Value>1]<-1
Trad<-Trad[Trad$Value >= 1, ]
Trad$Value[Trad$Value>1]<-1
Accuracy_Consistency(eDNA,Trad,"Method")
by_paper<-Accuracy_Consistency(eDNA, Trad, "Method")
Overall<-Accuracy_Consistency(eDNA, Trad,"")
Overall$Variable<-" All Methods"
c<-combine(by_paper, Overall)
mean_con<-mean(by_paper$Consistency)
CON_Plot<-ggplot(c, aes(x = Consistency, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Consistency_Lower`, xmax = `Consistency_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_con,  linetype = "Unweighted Mean"),color = "red")+
labs(x = "Consistency", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
mean_acc<-mean(by_paper$Accuracy)
ACC_plot<-ggplot(c, aes(x = Accuracy, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Accuracy_Lower`, xmax = `Accuracy_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_acc, linetype = "Unweighted Mean"), color = "red")+
labs(x = "Accuracy", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
# Combos methods ----
# We have to do this with the eDNA and Trad dataframes that don't have the conventional conventional methods the confidence intervals shrink when you include them due to repition.
eDNA<-read_excel("eDNA.xlsx")
Trad<-read_excel("Trad.xlsx")
eDNA<- eDNA%>% filter(Method %in% c("12S-EF","12S-HN", "12S-SN","12S-MT","12S-GN","COI-EF","COI-HN", "COI-SN","COI-MT","COI-GN"))
Trad<- Trad%>% filter(Method %in% c("12S-EF","12S-HN", "12S-SN","12S-MT","12S-GN","COI-EF","COI-HN", "COI-SN","COI-MT","COI-GN"))
eDNA$Sample[eDNA$Sample=="08-07-23 - SunC-REF"] <- "eDNA-EF,GN,HN"
eDNA$Sample[eDNA$Sample=="09-07-23 - SunC-REF"] <- "eDNA-GN,HN,MT"
eDNA$Sample[eDNA$Sample=="08-07-23 - SunC-EXP"] <- "eDNA-EF,GN,HN,MT"
eDNA$Sample[eDNA$Sample=="10-07-23 - KC-EXP"] <- "eDNA-EF,MT"
eDNA$Sample[eDNA$Sample=="11-07-23 - KC-REF"] <- "eDNA-EF,MT, SN"
eDNA$Sample[eDNA$Sample=="12-07-23 - SunC-FF"] <- "eDNA-EF,GN"
eDNA$Sample[eDNA$Sample=="09-07-23 - SunC-EXP"] <- "eDNA-GN,HN,SN"
eDNA$Sample[eDNA$Sample=="12-07-23 - RJ-POND"] <- "eDNA-GN,MT"
eDNA$Sample[eDNA$Sample=="12-07-23 - HC-REF"] <- "eDNA-EF,GN,HN"
eDNA$Sample[eDNA$Sample=="13-07-23 - HC-REF"] <- "eDNA-GN,HN"
Trad$Sample[Trad$Sample=="08-07-23 - SunC-REF"] <- "eDNA-EF,GN,HN"
Trad$Sample[Trad$Sample=="09-07-23 - SunC-REF"] <- "eDNA-GN,HN,MT"
Trad$Sample[Trad$Sample=="08-07-23 - SunC-EXP"] <- "eDNA-EF,GN,HN,MT"
Trad$Sample[Trad$Sample=="10-07-23 - KC-EXP"] <- "eDNA-EF,MT"
Trad$Sample[Trad$Sample=="11-07-23 - KC-REF"] <- "eDNA-EF,MT, SN"
Trad$Sample[Trad$Sample=="12-07-23 - SunC-FF"] <- "eDNA-EF,GN"
Trad$Sample[Trad$Sample=="09-07-23 - SunC-EXP"] <- "eDNA-GN,HN,SN"
Trad$Sample[Trad$Sample=="12-07-23 - RJ-POND"] <- "eDNA-GN,MT"
Trad$Sample[Trad$Sample=="12-07-23 - HC-REF"] <- "eDNA-EF,GN,HN"
Trad$Sample[Trad$Sample=="13-07-23 - HC-REF"] <- "eDNA-GN,HN"
eDNA <-eDNA[eDNA $Value >= 1, ]
eDNA$Value[eDNA $Value>1]<-1
Trad<-Trad[Trad$Value >= 1, ]
Trad$Value[Trad$Value>1]<-1
eDNA<-subset(eDNA, select=-c(Method))
Trad<-subset(Trad, select=-c(Method))
by_paper2<-Accuracy_Consistency(eDNA, Trad, "Sample")
Overall2<-Accuracy_Consistency(eDNA, Trad,"")
Overall2$Variable<-" All Methods"
c2<-combine(by_paper2, Overall2)
mean_con2<-mean(by_paper2$Consistency)
CON_Plot_Combo<-ggplot(c2, aes(x = Consistency, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Consistency_Lower`, xmax = `Consistency_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_con2,  linetype = "Unweighted Mean"),color = "red")+
labs(x = "Consistency", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
mean_acc2<-mean(by_paper2$Accuracy)
ACC_plot_Combo<-ggplot(c, aes(x = Accuracy, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Accuracy_Lower`, xmax = `Accuracy_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_acc2, linetype = "Unweighted Mean"), color = "red")+
labs(x = "Accuracy", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
# Consistency plot
Consistency_plot<-ggarrange(CON_Plot,CON_Plot_Combo,labels = c("A", "B"), font.label = list(size=10), nrow = 1, common.legend = TRUE, legend = "right")
Consistency_plot
c
c2
by_paper$type<-c("eDNA","eDNA","eDNA","eDNA","eDNA","eDNA","eDNA","eDNA","eDNA","eDNA","Trad","Trad","Trad","Trad","Trad","Trad","Trad","Trad","Trad","Trad")
library("car")
c
levene.test(by_paper$Consistency, by_paper$type)
leveneTest(by_paper$Consistency, by_paper$type)
shapiro.test(by_paper$Consistency)
a<-aov(by_paper$Consistency, by_paper$type)
a<-aov(by_paper$Consistency~ by_paper$type)
summary(a)
by_paper
by_paper_edna<-by_paper%>% filter(type %in% c("eDNA"))
by_paper_trad<-by_paper%>% filter(type %in% c("Trad"))
t.test(by_paper_edna$Consistency, by_paper_trad$Consistency)
kruskal.test(a)
a<-aov(by_paper$Consistency~ by_paper$type)
summary(a)
kruskal.test(a)
kruskal.test(by_paper$Consistency~ by_paper$type)
TukeyHSD(a)
0.289/0.145
c2
by_paper2
c2
mean_con2
0.4190917/0.3768116
0.419/0.217
# Function ----
all_all_not <- function(a, b) {
all <- intersect(a, b)
all_not <- symdiff(a, b)
# Create data frames with a single column for 'all' and 'all_not'
all<- data.frame(Value = all)
all_not <- data.frame(Value = all_not)
# Print the lengths of the data frames
all<-(nrow(all))
all_not <-(nrow(all_not))
data.frame(all=all, not=all_not)
}
Accuracy_Consistency<- function(a, b, column_name, conf.level = 0.95) {
# Check if the specified column is empty in either data frame
if (all(is.na(unique(a[[column_name]]))) || all(is.na(unique(b[[column_name]])))) {
print("The specified column is empty in one or both data frames. Comparing entire data frames.")
result <- all_all_not(a, b)
consistency <- sum(result$all) / (sum(result$all) + sum(result$not))
ci_consistency <- prop.test(sum(result$all), sum(result$all) + sum(result$not), conf.level = conf.level)$conf.int
ci_lower <- ci_consistency[1]
ci_upper <- ci_consistency[2]
accuracy <- sum(result$all) / nrow(a)
result$Consistency <- consistency
result$Consistency_Lower <- ci_lower
result$Consistency_Upper <- ci_upper
result$Accuracy <- accuracy
acc_ci <- prop.test(sum(result$all), nrow(a), conf.level = conf.level)$conf.int
result$Accuracy_Lower <- acc_ci[1]
result$Accuracy_Upper <- acc_ci[2]
return(result)
}
# Get unique values of the specified column from both data frames
values_a <- unique(a[[column_name]])
values_b <- unique(b[[column_name]])
# Initialize lists to store subsets
subsets_a <- list()
subsets_b <- list()
# Create subsets for data frame 'a'
for (value in values_a) {
subset_a <- subset(a, a[[column_name]] == value)
subsets_a[[as.character(value)]] <- subset_a
}
# Create subsets for data frame 'b'
for (value in values_b) {
subset_b <- subset(b, b[[column_name]] == value)
subsets_b[[as.character(value)]] <- subset_b
}
# Initialize a list to store results
results <- list()
# Apply 'all_all_not' function to each pair of non-empty subsets
for (value in names(subsets_a)) {
if (!is.null(subsets_a[[value]]) && !is.null(subsets_b[[value]])) {
print(paste("Processing value:", value))
result <- all_all_not(subsets_a[[value]], subsets_b[[value]])
consistency <- sum(result$all) / (sum(result$all) + sum(result$not))
ci_consistency <- prop.test(sum(result$all), sum(result$all) + sum(result$not), conf.level = conf.level)$conf.int
ci_lower_consistency <- ci_consistency[1]
ci_upper_consistency <- ci_consistency[2]
accuracy <- sum(result$all) / nrow(subsets_a[[value]])
result$Consistency <- consistency
result$Consistency_Lower <- ci_lower_consistency
result$Consistency_Upper <- ci_upper_consistency
result$Accuracy <- accuracy
acc_ci <- prop.test(sum(result$all), nrow(subsets_a[[value]]), conf.level = conf.level)$conf.int
result$Accuracy_Lower <- acc_ci[1]
result$Accuracy_Upper <- acc_ci[2]
results[[value]] <- result
}
}
# Combine results into a single data frame
if (length(results) > 0) {
df <- do.call(rbind, results)
df <- data.frame(Variable = row.names(df), df, row.names = NULL)
return(df)
} else {
print("No non-empty subsets found.")
return(NULL)
}
}
#----
# By method----
eDNA<-read_excel("eDNA.xlsx")
Trad<-read_excel("Trad.xlsx")
eDNA <-eDNA[eDNA $Value >= 1, ]
eDNA$Value[eDNA $Value>1]<-1
Trad<-Trad[Trad$Value >= 1, ]
Trad$Value[Trad$Value>1]<-1
Accuracy_Consistency(eDNA,Trad,"Method")
by_paper<-Accuracy_Consistency(eDNA, Trad, "Method")
Overall<-Accuracy_Consistency(eDNA, Trad,"")
Overall$Variable<-" All Methods"
c<-combine(by_paper, Overall)
mean_con<-mean(by_paper$Consistency)
CON_Plot<-ggplot(c, aes(x = Consistency, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Consistency_Lower`, xmax = `Consistency_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_con,  linetype = "Unweighted Mean"),color = "red")+
labs(x = "Consistency", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
mean_acc<-mean(by_paper$Accuracy)
ACC_plot<-ggplot(c, aes(x = Accuracy, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Accuracy_Lower`, xmax = `Accuracy_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_acc, linetype = "Unweighted Mean"), color = "red")+
labs(x = "Accuracy", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
# Combos methods ----
# We have to do this with the eDNA and Trad dataframes that don't have the conventional conventional methods the confidence intervals shrink when you include them due to repition.
eDNA<-read_excel("eDNA.xlsx")
Trad<-read_excel("Trad.xlsx")
eDNA<- eDNA%>% filter(Method %in% c("12S-EF","12S-HN", "12S-SN","12S-MT","12S-GN","COI-EF","COI-HN", "COI-SN","COI-MT","COI-GN"))
Trad<- Trad%>% filter(Method %in% c("12S-EF","12S-HN", "12S-SN","12S-MT","12S-GN","COI-EF","COI-HN", "COI-SN","COI-MT","COI-GN"))
eDNA$Sample[eDNA$Sample=="08-07-23 - SunC-REF"] <- "eDNA-EF,GN,HN"
eDNA$Sample[eDNA$Sample=="09-07-23 - SunC-REF"] <- "eDNA-GN,HN,MT"
eDNA$Sample[eDNA$Sample=="08-07-23 - SunC-EXP"] <- "eDNA-EF,GN,HN,MT"
eDNA$Sample[eDNA$Sample=="10-07-23 - KC-EXP"] <- "eDNA-EF,MT"
eDNA$Sample[eDNA$Sample=="11-07-23 - KC-REF"] <- "eDNA-EF,MT, SN"
eDNA$Sample[eDNA$Sample=="12-07-23 - SunC-FF"] <- "eDNA-EF,GN"
eDNA$Sample[eDNA$Sample=="09-07-23 - SunC-EXP"] <- "eDNA-GN,HN,SN"
eDNA$Sample[eDNA$Sample=="12-07-23 - RJ-POND"] <- "eDNA-GN,MT"
eDNA$Sample[eDNA$Sample=="12-07-23 - HC-REF"] <- "eDNA-EF,GN,HN"
eDNA$Sample[eDNA$Sample=="13-07-23 - HC-REF"] <- "eDNA-GN,HN"
Trad$Sample[Trad$Sample=="08-07-23 - SunC-REF"] <- "eDNA-EF,GN,HN"
Trad$Sample[Trad$Sample=="09-07-23 - SunC-REF"] <- "eDNA-GN,HN,MT"
Trad$Sample[Trad$Sample=="08-07-23 - SunC-EXP"] <- "eDNA-EF,GN,HN,MT"
Trad$Sample[Trad$Sample=="10-07-23 - KC-EXP"] <- "eDNA-EF,MT"
Trad$Sample[Trad$Sample=="11-07-23 - KC-REF"] <- "eDNA-EF,MT, SN"
Trad$Sample[Trad$Sample=="12-07-23 - SunC-FF"] <- "eDNA-EF,GN"
Trad$Sample[Trad$Sample=="09-07-23 - SunC-EXP"] <- "eDNA-GN,HN,SN"
Trad$Sample[Trad$Sample=="12-07-23 - RJ-POND"] <- "eDNA-GN,MT"
Trad$Sample[Trad$Sample=="12-07-23 - HC-REF"] <- "eDNA-EF,GN,HN"
Trad$Sample[Trad$Sample=="13-07-23 - HC-REF"] <- "eDNA-GN,HN"
eDNA <-eDNA[eDNA $Value >= 1, ]
eDNA$Value[eDNA $Value>1]<-1
Trad<-Trad[Trad$Value >= 1, ]
Trad$Value[Trad$Value>1]<-1
eDNA<-subset(eDNA, select=-c(Method))
Trad<-subset(Trad, select=-c(Method))
by_paper2<-Accuracy_Consistency(eDNA, Trad, "Sample")
Overall2<-Accuracy_Consistency(eDNA, Trad,"")
Overall2$Variable<-" All Methods"
c2<-combine(by_paper2, Overall2)
mean_con2<-mean(by_paper2$Consistency)
CON_Plot_Combo<-ggplot(c2, aes(x = Consistency, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Consistency_Lower`, xmax = `Consistency_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_con2,  linetype = "Unweighted Mean"),color = "red")+
labs(x = "Consistency", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
mean_acc2<-mean(by_paper2$Accuracy)
ACC_plot_Combo<-ggplot(c, aes(x = Accuracy, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Accuracy_Lower`, xmax = `Accuracy_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_acc2, linetype = "Unweighted Mean"), color = "red")+
labs(x = "Accuracy", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
library(ggpubr)
# Consistency plot
Consistency_plot<-ggarrange(CON_Plot,CON_Plot_Combo,labels = c("A", "B"), font.label = list(size=10), nrow = 1, common.legend = TRUE, legend = "right")
Consistency_plot
Accuracy_plot<-ggarrange(ACC_Plot,ACC_Plot_Combo,labels = c("A", "B"), font.label = list(size=10), nrow = 1, common.legend = TRUE, legend = "right")
Accuracy_plot<-ggarrange(ACC_plot,ACC_Plot_Combo,labels = c("A", "B"), font.label = list(size=10), nrow = 1, common.legend = TRUE, legend = "right")
Accuracy_plot<-ggarrange(ACC_plot,ACC_plot_Combo,labels = c("A", "B"), font.label = list(size=10), nrow = 1, common.legend = TRUE, legend = "right")
Accuracy_plot
ACC_plot_Combo<-ggplot(c2, aes(x = Accuracy, y = Variable)) +
geom_point(size = 1) +
geom_errorbarh(aes(xmin = `Accuracy_Lower`, xmax = `Accuracy_Upper`), height = 0.2) +
geom_vline(aes(xintercept = mean_acc2, linetype = "Unweighted Mean"), color = "red")+
labs(x = "Accuracy", y = "Method") +
theme_classic()+
theme(legend.text =element_text(size = 6,face = "bold"))+
theme(legend.key.size = unit(.2, 'cm')) +
theme(legend.title = element_text(size = 6,face = "bold"))+
guides(linetype = guide_legend(title = ""))+
theme(axis.text.x = element_text(size=6,face="bold"))+
theme(axis.title = element_text(size = 8,face="bold"))+
theme(axis.text.y = element_text(size=6,face="bold"))
Accuracy_plot<-ggarrange(ACC_plot,ACC_plot_Combo,labels = c("A", "B"), font.label = list(size=10), nrow = 1, common.legend = TRUE, legend = "right")
Accuracy_plot
mean_acc
c
0.3673042/0.3010033
0.415 /0.320
mean_acc2
0.1375959/0.1015625
0.367/0.138
